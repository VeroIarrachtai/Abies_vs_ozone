# Flag desired populations
flag <-  pop_code$V2 %in% c("NTSB", "CZ")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
NTSBvsCZ<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
NTSBvsCZ$Fst
##############
##"NTSB", "Tl"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("NTSB", "Tl")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
NTSBvsTl<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
NTSBvsTl$Fst
##############
##"NTSB", "Ma"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("NTSB", "Ma")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
NTSBvsMa<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
NTSBvsMa$Fst
##############
##"NTSB", "CP"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("NTSB", "CP")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
NTSBvsCP<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
NTSBvsCP$Fst
# VOLCAN ATLITZIN
##############
##"VA", "CZ"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("VA", "CZ")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
VAvsCZ<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
VAvsCZ$Fst
##############
##"VA", "Tl"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("VA", "Tl")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
VAvsTl<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
VAvsTl$Fst
##############
##"VA", "Ma"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("VA", "Ma")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
VAvsMa<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
VAvsMa$Fst
##############
##"VA", "CP"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("VA", "CP")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
VAvsCP<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
VAvsCP$Fst
#CERRO ZAMORANO
##############
##"CZ", "Tl"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("CZ", "Tl")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
CZvsTl<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
CZvsTl$Fst
##############
##"CZ", "Ma"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("CZ", "Ma")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
CZvsMa<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
CZvsMa$Fst
##############
##"CZ", "CP"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("CZ", "CP")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
CZvsCP<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
CZvsCP$Fst
#TLAXCO
##############
##"Tl", "Ma"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("Tl", "Ma")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
TlvsMa<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
TlvsMa$Fst
##############
##"Tl", "CP"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("Tl", "CP")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
TlvsCP<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
TlvsCP$Fst
# MALINCHE
##############
##"Ma", "CP"##
##############
# Flag desired populations
flag <-  pop_code$V2 %in% c("Ma", "CP")
samp.sel <- sample.id[flag]
pop.sel <- pop_code$V2[flag]
pop.sel<-droplevels(pop.sel)
# Estimate FST
MavsCP<-snpgdsFst(genofile, sample.id=samp.sel, population= as.factor(pop.sel), autosome.only = FALSE, remove.monosnp=TRUE, method="W&C84")
MavsCP$Fst
## Make a matrix to mantel test
SierraManantlan<-                                                                                                                                                                                                                               c(0,SMvsAj$Fst,SMvsSRX$Fst,SMvsEC$Fst,SMvsNC$Fst,SMvsNT$Fst,SMvsIx$Fst,SMvsCB$Fst,SMvsPG$Fst,SMvsVT$Fst,SMvsMiAl$Fst,SMvsSA$Fst,SMvsNTRG$Fst,SMvsNTSB$Fst,SMvsVA$Fst,SMvsCZ$Fst,SMvsTl$Fst,SMvsMa$Fst,SMvsCP$Fst)
Ajusco<-                                                                                                                                                                                                                               c(SMvsAj$Fst,0,AjvsSRX$Fst,AjvsEC$Fst,AjvsNC$Fst,AjvsNT$Fst,AjvsIx$Fst,AjvsCB$Fst,AjvsPG$Fst,AjvsVT$Fst,AjvsMiAl$Fst,AjvsSA$Fst,AjvsNTRG$Fst,AjvsNTSB$Fst,AjvsVA$Fst,AjvsCZ$Fst,AjvsTl$Fst,AjvsMa$Fst,AjvsCP$Fst)
SantaRosaXochiac<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsSRX$Fst,0,SRXvsEC$Fst,SRXvsNC$Fst,SRXvsNT$Fst,SRXvsIx$Fst,SRXvsCB$Fst,SRXvsPG$Fst,SRXvsVT$Fst,SRXvsMiAl$Fst,SRXvsSA$Fst,SRXvsNTRG$Fst,SRXvsNTSB$Fst,SRXvsVA$Fst,SRXvsCZ$Fst,SRXvsTl$Fst,SRXvsMa$Fst,SRXvsCP$Fst)
ElChico<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsEC$Fst,SRXvsEC$Fst,0,ECvsNC$Fst,ECvsNT$Fst,ECvsIx$Fst,ECvsCB$Fst,ECvsPG$Fst,ECvsVT$Fst,ECvsMiAl$Fst,ECvsSA$Fst,ECvsNTRG$Fst,ECvsNTSB$Fst,ECvsVA$Fst,ECvsCZ$Fst,ECvsTl$Fst,ECvsMa$Fst,ECvsCP$Fst)
NevadoColima<-                                                                                                                                                                                             c(SMvsAj$Fst,AjvsNC$Fst,SRXvsNC$Fst,ECvsNC$Fst,0,NCvsNT$Fst,NCvsIx$Fst,NCvsCB$Fst,NCvsPG$Fst,NCvsVT$Fst,NCvsMiAl$Fst,NCvsSA$Fst,NCvsNTRG$Fst,NCvsNTSB$Fst,NCvsVA$Fst,NCvsCZ$Fst,NCvsTl$Fst,NCvsMa$Fst,NCvsCP$Fst)
NevadoToluca<-                                                                                                                                                                                    c(SMvsAj$Fst,AjvsNT$Fst,SRXvsNT$Fst,ECvsNT$Fst,NCvsNT$Fst,0,NTvsIx$Fst,NTvsCB$Fst,NTvsPG$Fst,NTvsVT$Fst,NTvsMiAl$Fst,NTvsSA$Fst,NTvsNTRG$Fst,NTvsNTSB$Fst,NTvsVA$Fst,NTvsCZ$Fst,NTvsTl$Fst,NTvsMa$Fst,NTvsCP$Fst)
Ixtapaluca<-                                                                                                                                                                            c(SMvsAj$Fst,AjvsIx$Fst,SRXvsIx$Fst,ECvsIx$Fst,NCvsIx$Fst,NTvsIx$Fst,0,IxvsCB$Fst,IxvsPG$Fst,IxvsVT$Fst,IxvsMiAl$Fst,IxvsSA$Fst,IxvsNTRG$Fst,IxvsNTSB$Fst,IxvsVA$Fst,IxvsCZ$Fst,IxvsTl$Fst,IxvsMa$Fst,IxvsCP$Fst)
CerroBlanco<-                                                                                                                                                                 c(SMvsAj$Fst,AjvsCB$Fst,SRXvsCB$Fst,ECvsCB$Fst,NCvsCB$Fst,NTvsCB$Fst,IxvsCB$Fst,0,CBvsPG$Fst,CBvsVT$Fst,CBvsMiAl$Fst,CBvsSA$Fst,CBvsNTRG$Fst,CBvsNTSB$Fst,CBvsVA$Fst,CBvsCZ$Fst,CBvsTl$Fst,CBvsMa$Fst,CBvsCP$Fst)
PuertaGarnica<-                                                                                                                                                      c(SMvsAj$Fst,AjvsPG$Fst,SRXvsPG$Fst,ECvsPG$Fst,NCvsPG$Fst,NTvsPG$Fst,IxvsPG$Fst,CBvsPG$Fst,0,PGvsVT$Fst,PGvsMiAl$Fst,PGvsSA$Fst,PGvsNTRG$Fst,PGvsNTSB$Fst,PGvsVA$Fst,PGvsCZ$Fst,PGvsTl$Fst,PGvsMa$Fst,PGvsCP$Fst)
VolcanTancitaro<-                                                                                                                                           c(SMvsAj$Fst,AjvsVT$Fst,SRXvsVT$Fst,ECvsVT$Fst,NCvsVT$Fst,NTvsVT$Fst,IxvsVT$Fst,CBvsVT$Fst,PGvsVT$Fst,0,VTvsMiAl$Fst,VTvsSA$Fst,VTvsNTRG$Fst,VTvsNTSB$Fst,VTvsVA$Fst,VTvsCZ$Fst,VTvsTl$Fst,VTvsMa$Fst,VTvsCP$Fst)
Michoacan<-                                                                                                                      c(SMvsAj$Fst,AjvsMiAl$Fst,SRXvsMiAl$Fst,ECvsMiAl$Fst,NCvsMiAl$Fst,NTvsMiAl$Fst,IxvsMiAl$Fst,CBvsMiAl$Fst,PGvsMiAl$Fst,VTvsMiAl$Fst,0,MiAlvsSA$Fst,MiAlvsNTRG$Fst,MiAlvsNTSB$Fst,MiAlvsVA$Fst,MiAlvsCZ$Fst,MiAlvsTl$Fst,MiAlvsMa$Fst,MiAlvsCP$Fst)
SanAndres<-                                                                                                                            c(SMvsAj$Fst,AjvsSA$Fst,SRXvsSA$Fst,ECvsSA$Fst,NCvsSA$Fst,NTvsSA$Fst,IxvsSA$Fst,CBvsSA$Fst,PGvsSA$Fst,VTvsSA$Fst,MiAlvsSA$Fst,0,SAvsNTRG$Fst,SAvsNTSB$Fst,SAvsVA$Fst,SAvsCZ$Fst,SAvsTl$Fst,SAvsMa$Fst,SAvsCP$Fst)
NevadoTolucaRG<-                                                                                       c(SMvsAj$Fst,AjvsNTRG$Fst,SRXvsNTRG$Fst,ECvsNTRG$Fst,NCvsNTRG$Fst,NTvsNTRG$Fst,IxvsNTRG$Fst,CBvsNTRG$Fst,PGvsNTRG$Fst,VTvsNTRG$Fst,MiAlvsNTRG$Fst,SAvsNTRG$Fst,0,NTRGvsNTSB$Fst,NTRGvsVA$Fst,NTRGvsCZ$Fst,NTRGvsTl$Fst,NTRGvsMa$Fst,NTRGvsCP$Fst)
NevadoTolucaSB<-                                                                          c(SMvsAj$Fst,AjvsNTSB$Fst,SRXvsNTSB$Fst,ECvsNTSB$Fst,NCvsNTSB$Fst,NTvsNTSB$Fst,IxvsNTSB$Fst,CBvsNTSB$Fst,PGvsNTSB$Fst,VTvsNTSB$Fst,MiAlvsNTSB$Fst,SAvsNTSB$Fst,NTRGvsNTSB$Fst,0,NTSBvsVA$Fst,NTSBvsCZ$Fst,NTSBvsTl$Fst,NTSBvsMa$Fst,NTSBvsCP$Fst)
VolcanAtlitzin<-                                                                                       c(SMvsAj$Fst,AjvsVA$Fst,SRXvsVA$Fst,ECvsVA$Fst,NCvsVA$Fst,NTvsVA$Fst,IxvsVA$Fst,CBvsVA$Fst,PGvsVA$Fst,VTvsVA$Fst,MiAlvsVA$Fst,SAvsVA$Fst,NTRGvsVA$Fst,NTSBvsVA$Fst,0,VAvsCZ$Fst,VAvsTl$Fst,VAvsMa$Fst,VAvsCP$Fst)
CerroZamorano<-                                                                               c(SMvsAj$Fst,AjvsCZ$Fst,SRXvsCZ$Fst,ECvsCZ$Fst,NCvsCZ$Fst,NTvsCZ$Fst,IxvsCZ$Fst,CBvsCZ$Fst,PGvsCZ$Fst,VTvsCZ$Fst,MiAlvsCZ$Fst,SAvsCZ$Fst,NTRGvsCZ$Fst,NTSBvsCZ$Fst,VAvsCZ$Fst,0,CZvsTl$Fst,CZvsMa$Fst,CZvsCP$Fst)
Tlaxco<-                                                                             c(SMvsAj$Fst,AjvsTl$Fst,SRXvsTl$Fst,ECvsTl$Fst,NCvsTl$Fst,NTvsTl$Fst,IxvsTl$Fst,CBvsTl$Fst,PGvsTl$Fst,VTvsTl$Fst,MiAlvsTl$Fst,SAvsTl$Fst,NTRGvsTl$Fst,NTSBvsTl$Fst,VAvsTl$Fst,CZvsTl$Fst,0,TlvsMa$Fst,TlvsCP$Fst)
Malinche<-                                                                  c(SMvsAj$Fst,AjvsMa$Fst,SRXvsMa$Fst,ECvsMa$Fst,NCvsMa$Fst,NTvsMa$Fst,IxvsMa$Fst,CBvsMa$Fst,PGvsMa$Fst,VTvsMa$Fst,MiAlvsMa$Fst,SAvsMa$Fst,NTRGvsMa$Fst,NTSBvsMa$Fst,VAvsMa$Fst,CZvsMa$Fst,TlvsMa$Fst,0,MavsCP$Fst)
CofrePerote<-                                                      c(SMvsAj$Fst,AjvsCP$Fst,SRXvsCP$Fst,ECvsCP$Fst,NCvsCP$Fst,NTvsCP$Fst,IxvsCP$Fst,CBvsCP$Fst,PGvsCP$Fst,VTvsCP$Fst,MiAlvsCP$Fst,SAvsCP$Fst,NTRGvsCP$Fst,NTSBvsCP$Fst,VAvsCP$Fst,CZvsCP$Fst,TlvsCP$Fst,MavsCP$Fst,0)
mat <- cbind(SierraManantlan,Ajusco, SantaRosaXochiac, ElChico,NevadoColima,NevadoToluca,
Ixtapaluca,CerroBlanco,PuertaGarnica,VolcanTancitaro,Michoacan,
SanAndres,NevadoTolucaRG,NevadoTolucaSB,VolcanAtlitzin,
CerroZamorano,Tlaxco, Malinche,CofrePerote
)
mat2<- mat/(1-mat)
Fst.dists<- as.matrix(mat)
mountain.dists <- dist(cbind(x$Lon, x$Lat))
mountain.dists <- as.matrix(mountain.dists)[1:19, 1:19]
Fst.dists<- as.dist(mat)
mountain.dists <-as.dist(mountain.dists)
mantel(mountain.dists, Fst.dists, method="pearson", permutations=999)
########################################################################################################################################################################
# Linearize as suggested by Rousset (1997) for IBD using FST/(1 − FST)
IBD$FST_liner<- IBD$FST/(1-IBD$FST)
# Add Distance in Km.
IBD$Dist_km <- IBD$Dist/1000
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Geographic distance (Km)")+
ylab("DGenetic distancia")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
ggsave("../../outputs/5.1_Mantel_test_Linear.png")
CofrePerote<-                                                      c(SMvsAj$Fst,AjvsCP$Fst,SRXvsCP$Fst,ECvsCP$Fst,NCvsCP$Fst,NTvsCP$Fst,IxvsCP$Fst,CBvsCP$Fst,PGvsCP$Fst,VTvsCP$Fst,MiAlvsCP$Fst,SAvsCP$Fst,NTRGvsCP$Fst,NTSBvsCP$Fst,VAvsCP$Fst,CZvsCP$Fst,TlvsCP$Fst,MavsCP$Fst,0)
mat <- cbind(SierraManantlan,Ajusco, SantaRosaXochiac, ElChico,NevadoColima,NevadoToluca,
Ixtapaluca,CerroBlanco,PuertaGarnica,VolcanTancitaro,Michoacan,
SanAndres,NevadoTolucaRG,NevadoTolucaSB,VolcanAtlitzin,
CerroZamorano,Tlaxco, Malinche,CofrePerote
)
mat2<- mat/(1-mat)
Fst.dists<- as.matrix(mat)
mountain.dists <- dist(cbind(x$Lon, x$Lat))
mountain.dists <- as.matrix(mountain.dists)[1:19, 1:19]
Fst.dists<- as.dist(mat)
mountain.dists <-as.dist(mountain.dists)
mantel(mountain.dists, Fst.dists, method="pearson", permutations=999)
# Linearize as suggested by Rousset (1997) for IBD using FST/(1 − FST)
IBD$FST_liner<- IBD$FST/(1-IBD$FST)
IBD<-read.delim("../../metadata/Ar_IBD_comparations.txt")
IBD$FST<-allvectorfst
## Make matrix with FST data
allvectorfst<- c(SMvsSRX$Fst,SMvsSRX$Fst,SMvsEC$Fst,SMvsNC$Fst,SMvsNT$Fst,SMvsIx$Fst,SMvsCB$Fst,SMvsPG$Fst,SMvsVT$Fst,SMvsMiAl$Fst,SMvsSA$Fst,SMvsNTRG$Fst,SMvsNTSB$Fst,SMvsVA$Fst,SMvsCZ$Fst,SMvsTl$Fst,SMvsMa$Fst,SMvsCP$Fst,
AjvsSRX$Fst,AjvsEC$Fst,AjvsNC$Fst,AjvsNT$Fst,AjvsIx$Fst,AjvsCB$Fst,AjvsPG$Fst,AjvsVT$Fst,AjvsMiAl$Fst,AjvsSA$Fst,AjvsNTRG$Fst,AjvsNTSB$Fst,AjvsVA$Fst,AjvsCZ$Fst,AjvsTl$Fst,AjvsMa$Fst,AjvsCP$Fst,
SRXvsEC$Fst,SRXvsNC$Fst,SRXvsNT$Fst,SRXvsIx$Fst,SRXvsCB$Fst,SRXvsPG$Fst,SRXvsVT$Fst,SRXvsMiAl$Fst,SRXvsSA$Fst,SRXvsNTRG$Fst,SRXvsNTSB$Fst,SRXvsVA$Fst,SRXvsCZ$Fst,SRXvsTl$Fst,SRXvsMa$Fst,SRXvsCP$Fst,
ECvsNC$Fst,ECvsNT$Fst,ECvsIx$Fst,ECvsCB$Fst,ECvsPG$Fst,ECvsVT$Fst,ECvsMiAl$Fst,ECvsSA$Fst,ECvsNTRG$Fst,ECvsNTSB$Fst,ECvsVA$Fst,ECvsCZ$Fst,ECvsTl$Fst,ECvsMa$Fst,ECvsCP$Fst,
NCvsNT$Fst,NCvsIx$Fst,NCvsCB$Fst,NCvsPG$Fst,NCvsVT$Fst,NCvsMiAl$Fst,NCvsSA$Fst,NCvsNTRG$Fst,NCvsNTSB$Fst,NCvsVA$Fst,NCvsCZ$Fst,NCvsTl$Fst,NCvsMa$Fst,NCvsCP$Fst,
NTvsIx$Fst,NTvsCB$Fst,NTvsPG$Fst,NTvsVT$Fst,NTvsMiAl$Fst,NTvsSA$Fst,NTvsNTRG$Fst,NTvsNTSB$Fst,NTvsVA$Fst,NTvsCZ$Fst,NTvsTl$Fst,NTvsMa$Fst,NTvsCP$Fst,
IxvsCB$Fst,IxvsPG$Fst,IxvsVT$Fst,IxvsMiAl$Fst,IxvsSA$Fst,IxvsNTRG$Fst,IxvsNTSB$Fst,IxvsVA$Fst,IxvsCZ$Fst,IxvsTl$Fst,IxvsMa$Fst,IxvsCP$Fst,
CBvsPG$Fst,CBvsVT$Fst,CBvsMiAl$Fst,CBvsSA$Fst,CBvsNTRG$Fst,CBvsNTSB$Fst,CBvsVA$Fst,CBvsCZ$Fst,CBvsTl$Fst,CBvsMa$Fst,CBvsCP$Fst,
PGvsVT$Fst,PGvsMiAl$Fst,PGvsSA$Fst,PGvsNTRG$Fst,PGvsNTSB$Fst,PGvsVA$Fst,PGvsCZ$Fst,PGvsTl$Fst,PGvsMa$Fst,PGvsCP$Fst,
VTvsMiAl$Fst,VTvsSA$Fst,VTvsNTRG$Fst,VTvsNTSB$Fst,VTvsVA$Fst,VTvsCZ$Fst,VTvsTl$Fst,VTvsMa$Fst,VTvsCP$Fst,
MiAlvsSA$Fst,MiAlvsNTRG$Fst,MiAlvsNTSB$Fst,MiAlvsVA$Fst,MiAlvsCZ$Fst,MiAlvsTl$Fst,MiAlvsMa$Fst,MiAlvsCP$Fst,
SAvsNTRG$Fst,SAvsNTSB$Fst,SAvsVA$Fst,SAvsCZ$Fst,SAvsTl$Fst,SAvsMa$Fst,SAvsCP$Fst,
NTRGvsNTSB$Fst,NTRGvsVA$Fst,NTRGvsCZ$Fst,NTRGvsTl$Fst,NTRGvsMa$Fst,NTRGvsCP$Fst,
NTSBvsVA$Fst,NTSBvsCZ$Fst,NTSBvsTl$Fst,NTSBvsMa$Fst,NTSBvsCP$Fst,
VAvsCZ$Fst,VAvsTl$Fst,VAvsMa$Fst,VAvsCP$Fst,
CZvsTl$Fst,CZvsMa$Fst,CZvsCP$Fst,
TlvsMa$Fst,TlvsCP$Fst,
MavsCP$Fst
)
IBD<-read.delim("../../metadata/Ar_IBD_comparations.txt")
IBD$FST<-allvectorfst
IBD$Dist<-allvectordist
IBD$Dist_km <- IBD$Dist/1000
## Draw IBD
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST)) +
geom_point(colour = "#e60000") +
xlab("Distancia geográfica (Km)")+
ylab("Distancia Genética")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Make a matrix to mantel test
SierraManantlan<-                                                                                                                                                                                                                               c(0,SMvsAj$Fst,SMvsSRX$Fst,SMvsEC$Fst,SMvsNC$Fst,SMvsNT$Fst,SMvsIx$Fst,SMvsCB$Fst,SMvsPG$Fst,SMvsVT$Fst,SMvsMiAl$Fst,SMvsSA$Fst,SMvsNTRG$Fst,SMvsNTSB$Fst,SMvsVA$Fst,SMvsCZ$Fst,SMvsTl$Fst,SMvsMa$Fst,SMvsCP$Fst)
Ajusco<-                                                                                                                                                                                                                               c(SMvsAj$Fst,0,AjvsSRX$Fst,AjvsEC$Fst,AjvsNC$Fst,AjvsNT$Fst,AjvsIx$Fst,AjvsCB$Fst,AjvsPG$Fst,AjvsVT$Fst,AjvsMiAl$Fst,AjvsSA$Fst,AjvsNTRG$Fst,AjvsNTSB$Fst,AjvsVA$Fst,AjvsCZ$Fst,AjvsTl$Fst,AjvsMa$Fst,AjvsCP$Fst)
SantaRosaXochiac<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsSRX$Fst,0,SRXvsEC$Fst,SRXvsNC$Fst,SRXvsNT$Fst,SRXvsIx$Fst,SRXvsCB$Fst,SRXvsPG$Fst,SRXvsVT$Fst,SRXvsMiAl$Fst,SRXvsSA$Fst,SRXvsNTRG$Fst,SRXvsNTSB$Fst,SRXvsVA$Fst,SRXvsCZ$Fst,SRXvsTl$Fst,SRXvsMa$Fst,SRXvsCP$Fst)
ElChico<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsEC$Fst,SRXvsEC$Fst,0,ECvsNC$Fst,ECvsNT$Fst,ECvsIx$Fst,ECvsCB$Fst,ECvsPG$Fst,ECvsVT$Fst,ECvsMiAl$Fst,ECvsSA$Fst,ECvsNTRG$Fst,ECvsNTSB$Fst,ECvsVA$Fst,ECvsCZ$Fst,ECvsTl$Fst,ECvsMa$Fst,ECvsCP$Fst)
NevadoColima<-                                                                                                                                                                                             c(SMvsAj$Fst,AjvsNC$Fst,SRXvsNC$Fst,ECvsNC$Fst,0,NCvsNT$Fst,NCvsIx$Fst,NCvsCB$Fst,NCvsPG$Fst,NCvsVT$Fst,NCvsMiAl$Fst,NCvsSA$Fst,NCvsNTRG$Fst,NCvsNTSB$Fst,NCvsVA$Fst,NCvsCZ$Fst,NCvsTl$Fst,NCvsMa$Fst,NCvsCP$Fst)
NevadoToluca<-                                                                                                                                                                                    c(SMvsAj$Fst,AjvsNT$Fst,SRXvsNT$Fst,ECvsNT$Fst,NCvsNT$Fst,0,NTvsIx$Fst,NTvsCB$Fst,NTvsPG$Fst,NTvsVT$Fst,NTvsMiAl$Fst,NTvsSA$Fst,NTvsNTRG$Fst,NTvsNTSB$Fst,NTvsVA$Fst,NTvsCZ$Fst,NTvsTl$Fst,NTvsMa$Fst,NTvsCP$Fst)
Ixtapaluca<-                                                                                                                                                                            c(SMvsAj$Fst,AjvsIx$Fst,SRXvsIx$Fst,ECvsIx$Fst,NCvsIx$Fst,NTvsIx$Fst,0,IxvsCB$Fst,IxvsPG$Fst,IxvsVT$Fst,IxvsMiAl$Fst,IxvsSA$Fst,IxvsNTRG$Fst,IxvsNTSB$Fst,IxvsVA$Fst,IxvsCZ$Fst,IxvsTl$Fst,IxvsMa$Fst,IxvsCP$Fst)
CerroBlanco<-                                                                                                                                                                 c(SMvsAj$Fst,AjvsCB$Fst,SRXvsCB$Fst,ECvsCB$Fst,NCvsCB$Fst,NTvsCB$Fst,IxvsCB$Fst,0,CBvsPG$Fst,CBvsVT$Fst,CBvsMiAl$Fst,CBvsSA$Fst,CBvsNTRG$Fst,CBvsNTSB$Fst,CBvsVA$Fst,CBvsCZ$Fst,CBvsTl$Fst,CBvsMa$Fst,CBvsCP$Fst)
PuertaGarnica<-                                                                                                                                                      c(SMvsAj$Fst,AjvsPG$Fst,SRXvsPG$Fst,ECvsPG$Fst,NCvsPG$Fst,NTvsPG$Fst,IxvsPG$Fst,CBvsPG$Fst,0,PGvsVT$Fst,PGvsMiAl$Fst,PGvsSA$Fst,PGvsNTRG$Fst,PGvsNTSB$Fst,PGvsVA$Fst,PGvsCZ$Fst,PGvsTl$Fst,PGvsMa$Fst,PGvsCP$Fst)
VolcanTancitaro<-                                                                                                                                           c(SMvsAj$Fst,AjvsVT$Fst,SRXvsVT$Fst,ECvsVT$Fst,NCvsVT$Fst,NTvsVT$Fst,IxvsVT$Fst,CBvsVT$Fst,PGvsVT$Fst,0,VTvsMiAl$Fst,VTvsSA$Fst,VTvsNTRG$Fst,VTvsNTSB$Fst,VTvsVA$Fst,VTvsCZ$Fst,VTvsTl$Fst,VTvsMa$Fst,VTvsCP$Fst)
Michoacan<-                                                                                                                      c(SMvsAj$Fst,AjvsMiAl$Fst,SRXvsMiAl$Fst,ECvsMiAl$Fst,NCvsMiAl$Fst,NTvsMiAl$Fst,IxvsMiAl$Fst,CBvsMiAl$Fst,PGvsMiAl$Fst,VTvsMiAl$Fst,0,MiAlvsSA$Fst,MiAlvsNTRG$Fst,MiAlvsNTSB$Fst,MiAlvsVA$Fst,MiAlvsCZ$Fst,MiAlvsTl$Fst,MiAlvsMa$Fst,MiAlvsCP$Fst)
SanAndres<-                                                                                                                            c(SMvsAj$Fst,AjvsSA$Fst,SRXvsSA$Fst,ECvsSA$Fst,NCvsSA$Fst,NTvsSA$Fst,IxvsSA$Fst,CBvsSA$Fst,PGvsSA$Fst,VTvsSA$Fst,MiAlvsSA$Fst,0,SAvsNTRG$Fst,SAvsNTSB$Fst,SAvsVA$Fst,SAvsCZ$Fst,SAvsTl$Fst,SAvsMa$Fst,SAvsCP$Fst)
NevadoTolucaRG<-                                                                                       c(SMvsAj$Fst,AjvsNTRG$Fst,SRXvsNTRG$Fst,ECvsNTRG$Fst,NCvsNTRG$Fst,NTvsNTRG$Fst,IxvsNTRG$Fst,CBvsNTRG$Fst,PGvsNTRG$Fst,VTvsNTRG$Fst,MiAlvsNTRG$Fst,SAvsNTRG$Fst,0,NTRGvsNTSB$Fst,NTRGvsVA$Fst,NTRGvsCZ$Fst,NTRGvsTl$Fst,NTRGvsMa$Fst,NTRGvsCP$Fst)
NevadoTolucaSB<-                                                                          c(SMvsAj$Fst,AjvsNTSB$Fst,SRXvsNTSB$Fst,ECvsNTSB$Fst,NCvsNTSB$Fst,NTvsNTSB$Fst,IxvsNTSB$Fst,CBvsNTSB$Fst,PGvsNTSB$Fst,VTvsNTSB$Fst,MiAlvsNTSB$Fst,SAvsNTSB$Fst,NTRGvsNTSB$Fst,0,NTSBvsVA$Fst,NTSBvsCZ$Fst,NTSBvsTl$Fst,NTSBvsMa$Fst,NTSBvsCP$Fst)
VolcanAtlitzin<-                                                                                       c(SMvsAj$Fst,AjvsVA$Fst,SRXvsVA$Fst,ECvsVA$Fst,NCvsVA$Fst,NTvsVA$Fst,IxvsVA$Fst,CBvsVA$Fst,PGvsVA$Fst,VTvsVA$Fst,MiAlvsVA$Fst,SAvsVA$Fst,NTRGvsVA$Fst,NTSBvsVA$Fst,0,VAvsCZ$Fst,VAvsTl$Fst,VAvsMa$Fst,VAvsCP$Fst)
CerroZamorano<-                                                                               c(SMvsAj$Fst,AjvsCZ$Fst,SRXvsCZ$Fst,ECvsCZ$Fst,NCvsCZ$Fst,NTvsCZ$Fst,IxvsCZ$Fst,CBvsCZ$Fst,PGvsCZ$Fst,VTvsCZ$Fst,MiAlvsCZ$Fst,SAvsCZ$Fst,NTRGvsCZ$Fst,NTSBvsCZ$Fst,VAvsCZ$Fst,0,CZvsTl$Fst,CZvsMa$Fst,CZvsCP$Fst)
Tlaxco<-                                                                             c(SMvsAj$Fst,AjvsTl$Fst,SRXvsTl$Fst,ECvsTl$Fst,NCvsTl$Fst,NTvsTl$Fst,IxvsTl$Fst,CBvsTl$Fst,PGvsTl$Fst,VTvsTl$Fst,MiAlvsTl$Fst,SAvsTl$Fst,NTRGvsTl$Fst,NTSBvsTl$Fst,VAvsTl$Fst,CZvsTl$Fst,0,TlvsMa$Fst,TlvsCP$Fst)
Malinche<-                                                                  c(SMvsAj$Fst,AjvsMa$Fst,SRXvsMa$Fst,ECvsMa$Fst,NCvsMa$Fst,NTvsMa$Fst,IxvsMa$Fst,CBvsMa$Fst,PGvsMa$Fst,VTvsMa$Fst,MiAlvsMa$Fst,SAvsMa$Fst,NTRGvsMa$Fst,NTSBvsMa$Fst,VAvsMa$Fst,CZvsMa$Fst,TlvsMa$Fst,0,MavsCP$Fst)
CofrePerote<-                                                      c(SMvsAj$Fst,AjvsCP$Fst,SRXvsCP$Fst,ECvsCP$Fst,NCvsCP$Fst,NTvsCP$Fst,IxvsCP$Fst,CBvsCP$Fst,PGvsCP$Fst,VTvsCP$Fst,MiAlvsCP$Fst,SAvsCP$Fst,NTRGvsCP$Fst,NTSBvsCP$Fst,VAvsCP$Fst,CZvsCP$Fst,TlvsCP$Fst,MavsCP$Fst,0)
mat <- cbind(SierraManantlan,Ajusco, SantaRosaXochiac, ElChico,NevadoColima,NevadoToluca,
Ixtapaluca,CerroBlanco,PuertaGarnica,VolcanTancitaro,Michoacan,
SanAndres,NevadoTolucaRG,NevadoTolucaSB,VolcanAtlitzin,
CerroZamorano,Tlaxco, Malinche,CofrePerote
)
mat2<- mat/(1-mat)
Fst.dists<- as.matrix(mat)
mountain.dists <- dist(cbind(x$Lon, x$Lat))
mountain.dists <- as.matrix(mountain.dists)[1:19, 1:19]
Fst.dists<- as.dist(mat)
mountain.dists <-as.dist(mountain.dists)
mantel(mountain.dists, Fst.dists, method="pearson", permutations=999)
# Linearize as suggested by Rousset (1997) for IBD using FST/(1 − FST)
IBD$FST_liner<- IBD$FST/(1-IBD$FST)
IBD$Dist_km <- IBD$Dist/1000
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Distancia geográfica (Km)")+
ylab("Distancia Genética")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Geographic distance (Km)")+
ylab("Genetic distance")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Geographic distance (Km)")+
ylab("Genetic distance")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
View(x)
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Geographic distance (Km)")+
ylab("Genetic distance")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
IBD
View(IBD)
View(IBD)
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Geographic distance (Km)")+
ylab("Genetic distance")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Make matrix with FST data
allvectorfst<- c(SMvsSRX$Fst,SMvsSRX$Fst,SMvsEC$Fst,SMvsNC$Fst,SMvsNT$Fst,SMvsIx$Fst,SMvsCB$Fst,SMvsPG$Fst,SMvsVT$Fst,SMvsMiAl$Fst,SMvsSA$Fst,SMvsNTRG$Fst,SMvsNTSB$Fst,SMvsVA$Fst,SMvsCZ$Fst,SMvsTl$Fst,SMvsMa$Fst,SMvsCP$Fst,
AjvsSRX$Fst,AjvsEC$Fst,AjvsNC$Fst,AjvsNT$Fst,AjvsIx$Fst,AjvsCB$Fst,AjvsPG$Fst,AjvsVT$Fst,AjvsMiAl$Fst,AjvsSA$Fst,AjvsNTRG$Fst,AjvsNTSB$Fst,AjvsVA$Fst,AjvsCZ$Fst,AjvsTl$Fst,AjvsMa$Fst,AjvsCP$Fst,
SRXvsEC$Fst,SRXvsNC$Fst,SRXvsNT$Fst,SRXvsIx$Fst,SRXvsCB$Fst,SRXvsPG$Fst,SRXvsVT$Fst,SRXvsMiAl$Fst,SRXvsSA$Fst,SRXvsNTRG$Fst,SRXvsNTSB$Fst,SRXvsVA$Fst,SRXvsCZ$Fst,SRXvsTl$Fst,SRXvsMa$Fst,SRXvsCP$Fst,
ECvsNC$Fst,ECvsNT$Fst,ECvsIx$Fst,ECvsCB$Fst,ECvsPG$Fst,ECvsVT$Fst,ECvsMiAl$Fst,ECvsSA$Fst,ECvsNTRG$Fst,ECvsNTSB$Fst,ECvsVA$Fst,ECvsCZ$Fst,ECvsTl$Fst,ECvsMa$Fst,ECvsCP$Fst,
NCvsNT$Fst,NCvsIx$Fst,NCvsCB$Fst,NCvsPG$Fst,NCvsVT$Fst,NCvsMiAl$Fst,NCvsSA$Fst,NCvsNTRG$Fst,NCvsNTSB$Fst,NCvsVA$Fst,NCvsCZ$Fst,NCvsTl$Fst,NCvsMa$Fst,NCvsCP$Fst,
NTvsIx$Fst,NTvsCB$Fst,NTvsPG$Fst,NTvsVT$Fst,NTvsMiAl$Fst,NTvsSA$Fst,NTvsNTRG$Fst,NTvsNTSB$Fst,NTvsVA$Fst,NTvsCZ$Fst,NTvsTl$Fst,NTvsMa$Fst,NTvsCP$Fst,
IxvsCB$Fst,IxvsPG$Fst,IxvsVT$Fst,IxvsMiAl$Fst,IxvsSA$Fst,IxvsNTRG$Fst,IxvsNTSB$Fst,IxvsVA$Fst,IxvsCZ$Fst,IxvsTl$Fst,IxvsMa$Fst,IxvsCP$Fst,
CBvsPG$Fst,CBvsVT$Fst,CBvsMiAl$Fst,CBvsSA$Fst,CBvsNTRG$Fst,CBvsNTSB$Fst,CBvsVA$Fst,CBvsCZ$Fst,CBvsTl$Fst,CBvsMa$Fst,CBvsCP$Fst,
PGvsVT$Fst,PGvsMiAl$Fst,PGvsSA$Fst,PGvsNTRG$Fst,PGvsNTSB$Fst,PGvsVA$Fst,PGvsCZ$Fst,PGvsTl$Fst,PGvsMa$Fst,PGvsCP$Fst,
VTvsMiAl$Fst,VTvsSA$Fst,VTvsNTRG$Fst,VTvsNTSB$Fst,VTvsVA$Fst,VTvsCZ$Fst,VTvsTl$Fst,VTvsMa$Fst,VTvsCP$Fst,
MiAlvsSA$Fst,MiAlvsNTRG$Fst,MiAlvsNTSB$Fst,MiAlvsVA$Fst,MiAlvsCZ$Fst,MiAlvsTl$Fst,MiAlvsMa$Fst,MiAlvsCP$Fst,
SAvsNTRG$Fst,SAvsNTSB$Fst,SAvsVA$Fst,SAvsCZ$Fst,SAvsTl$Fst,SAvsMa$Fst,SAvsCP$Fst,
NTRGvsNTSB$Fst,NTRGvsVA$Fst,NTRGvsCZ$Fst,NTRGvsTl$Fst,NTRGvsMa$Fst,NTRGvsCP$Fst,
NTSBvsVA$Fst,NTSBvsCZ$Fst,NTSBvsTl$Fst,NTSBvsMa$Fst,NTSBvsCP$Fst,
VAvsCZ$Fst,VAvsTl$Fst,VAvsMa$Fst,VAvsCP$Fst,
CZvsTl$Fst,CZvsMa$Fst,CZvsCP$Fst,
TlvsMa$Fst,TlvsCP$Fst,
MavsCP$Fst
)
IBD<-read.delim("../../metadata/Ar_IBD_comparations.txt")
IBD$FST<-allvectorfst
IBD$Dist<-allvectordist
IBD$Dist_km <- IBD$Dist/1000
## Draw IBD
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST)) +
geom_point(colour = "#e60000") +
xlab("Distancia geográfica (Km)")+
ylab("Distancia Genética")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
ggsave("../../outputs/5.1_Mantel_test_NON_Linear.png")
## Make  mantel test
pairs(x = IBD, lower.panel = NULL)
pairs.panels(x = IBD, ellipses = FALSE, lm = TRUE, method = "pearson")
## Make a matrix to mantel test
SierraManantlan<-                                                                                                                                                                                                                               c(0,SMvsAj$Fst,SMvsSRX$Fst,SMvsEC$Fst,SMvsNC$Fst,SMvsNT$Fst,SMvsIx$Fst,SMvsCB$Fst,SMvsPG$Fst,SMvsVT$Fst,SMvsMiAl$Fst,SMvsSA$Fst,SMvsNTRG$Fst,SMvsNTSB$Fst,SMvsVA$Fst,SMvsCZ$Fst,SMvsTl$Fst,SMvsMa$Fst,SMvsCP$Fst)
Ajusco<-                                                                                                                                                                                                                               c(SMvsAj$Fst,0,AjvsSRX$Fst,AjvsEC$Fst,AjvsNC$Fst,AjvsNT$Fst,AjvsIx$Fst,AjvsCB$Fst,AjvsPG$Fst,AjvsVT$Fst,AjvsMiAl$Fst,AjvsSA$Fst,AjvsNTRG$Fst,AjvsNTSB$Fst,AjvsVA$Fst,AjvsCZ$Fst,AjvsTl$Fst,AjvsMa$Fst,AjvsCP$Fst)
SantaRosaXochiac<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsSRX$Fst,0,SRXvsEC$Fst,SRXvsNC$Fst,SRXvsNT$Fst,SRXvsIx$Fst,SRXvsCB$Fst,SRXvsPG$Fst,SRXvsVT$Fst,SRXvsMiAl$Fst,SRXvsSA$Fst,SRXvsNTRG$Fst,SRXvsNTSB$Fst,SRXvsVA$Fst,SRXvsCZ$Fst,SRXvsTl$Fst,SRXvsMa$Fst,SRXvsCP$Fst)
ElChico<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsEC$Fst,SRXvsEC$Fst,0,ECvsNC$Fst,ECvsNT$Fst,ECvsIx$Fst,ECvsCB$Fst,ECvsPG$Fst,ECvsVT$Fst,ECvsMiAl$Fst,ECvsSA$Fst,ECvsNTRG$Fst,ECvsNTSB$Fst,ECvsVA$Fst,ECvsCZ$Fst,ECvsTl$Fst,ECvsMa$Fst,ECvsCP$Fst)
## Draw IBD
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST)) +
geom_point(colour = "#e60000") +
xlab("Distancia geográfica (Km)")+
ylab("Distancia Genética")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Make  mantel test
pairs(x = IBD, lower.panel = NULL)
pairs.panels(x = IBD, ellipses = FALSE, lm = TRUE, method = "pearson")
## Make a matrix to mantel test
SierraManantlan<-                                                                                                                                                                                                                               c(0,SMvsAj$Fst,SMvsSRX$Fst,SMvsEC$Fst,SMvsNC$Fst,SMvsNT$Fst,SMvsIx$Fst,SMvsCB$Fst,SMvsPG$Fst,SMvsVT$Fst,SMvsMiAl$Fst,SMvsSA$Fst,SMvsNTRG$Fst,SMvsNTSB$Fst,SMvsVA$Fst,SMvsCZ$Fst,SMvsTl$Fst,SMvsMa$Fst,SMvsCP$Fst)
Ajusco<-                                                                                                                                                                                                                               c(SMvsAj$Fst,0,AjvsSRX$Fst,AjvsEC$Fst,AjvsNC$Fst,AjvsNT$Fst,AjvsIx$Fst,AjvsCB$Fst,AjvsPG$Fst,AjvsVT$Fst,AjvsMiAl$Fst,AjvsSA$Fst,AjvsNTRG$Fst,AjvsNTSB$Fst,AjvsVA$Fst,AjvsCZ$Fst,AjvsTl$Fst,AjvsMa$Fst,AjvsCP$Fst)
SantaRosaXochiac<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsSRX$Fst,0,SRXvsEC$Fst,SRXvsNC$Fst,SRXvsNT$Fst,SRXvsIx$Fst,SRXvsCB$Fst,SRXvsPG$Fst,SRXvsVT$Fst,SRXvsMiAl$Fst,SRXvsSA$Fst,SRXvsNTRG$Fst,SRXvsNTSB$Fst,SRXvsVA$Fst,SRXvsCZ$Fst,SRXvsTl$Fst,SRXvsMa$Fst,SRXvsCP$Fst)
ElChico<-                                                                                                                                                                                                           c(SMvsAj$Fst,AjvsEC$Fst,SRXvsEC$Fst,0,ECvsNC$Fst,ECvsNT$Fst,ECvsIx$Fst,ECvsCB$Fst,ECvsPG$Fst,ECvsVT$Fst,ECvsMiAl$Fst,ECvsSA$Fst,ECvsNTRG$Fst,ECvsNTSB$Fst,ECvsVA$Fst,ECvsCZ$Fst,ECvsTl$Fst,ECvsMa$Fst,ECvsCP$Fst)
NevadoColima<-                                                                                                                                                                                             c(SMvsAj$Fst,AjvsNC$Fst,SRXvsNC$Fst,ECvsNC$Fst,0,NCvsNT$Fst,NCvsIx$Fst,NCvsCB$Fst,NCvsPG$Fst,NCvsVT$Fst,NCvsMiAl$Fst,NCvsSA$Fst,NCvsNTRG$Fst,NCvsNTSB$Fst,NCvsVA$Fst,NCvsCZ$Fst,NCvsTl$Fst,NCvsMa$Fst,NCvsCP$Fst)
NevadoToluca<-                                                                                                                                                                                    c(SMvsAj$Fst,AjvsNT$Fst,SRXvsNT$Fst,ECvsNT$Fst,NCvsNT$Fst,0,NTvsIx$Fst,NTvsCB$Fst,NTvsPG$Fst,NTvsVT$Fst,NTvsMiAl$Fst,NTvsSA$Fst,NTvsNTRG$Fst,NTvsNTSB$Fst,NTvsVA$Fst,NTvsCZ$Fst,NTvsTl$Fst,NTvsMa$Fst,NTvsCP$Fst)
Ixtapaluca<-                                                                                                                                                                            c(SMvsAj$Fst,AjvsIx$Fst,SRXvsIx$Fst,ECvsIx$Fst,NCvsIx$Fst,NTvsIx$Fst,0,IxvsCB$Fst,IxvsPG$Fst,IxvsVT$Fst,IxvsMiAl$Fst,IxvsSA$Fst,IxvsNTRG$Fst,IxvsNTSB$Fst,IxvsVA$Fst,IxvsCZ$Fst,IxvsTl$Fst,IxvsMa$Fst,IxvsCP$Fst)
CerroBlanco<-                                                                                                                                                                 c(SMvsAj$Fst,AjvsCB$Fst,SRXvsCB$Fst,ECvsCB$Fst,NCvsCB$Fst,NTvsCB$Fst,IxvsCB$Fst,0,CBvsPG$Fst,CBvsVT$Fst,CBvsMiAl$Fst,CBvsSA$Fst,CBvsNTRG$Fst,CBvsNTSB$Fst,CBvsVA$Fst,CBvsCZ$Fst,CBvsTl$Fst,CBvsMa$Fst,CBvsCP$Fst)
PuertaGarnica<-                                                                                                                                                      c(SMvsAj$Fst,AjvsPG$Fst,SRXvsPG$Fst,ECvsPG$Fst,NCvsPG$Fst,NTvsPG$Fst,IxvsPG$Fst,CBvsPG$Fst,0,PGvsVT$Fst,PGvsMiAl$Fst,PGvsSA$Fst,PGvsNTRG$Fst,PGvsNTSB$Fst,PGvsVA$Fst,PGvsCZ$Fst,PGvsTl$Fst,PGvsMa$Fst,PGvsCP$Fst)
VolcanTancitaro<-                                                                                                                                           c(SMvsAj$Fst,AjvsVT$Fst,SRXvsVT$Fst,ECvsVT$Fst,NCvsVT$Fst,NTvsVT$Fst,IxvsVT$Fst,CBvsVT$Fst,PGvsVT$Fst,0,VTvsMiAl$Fst,VTvsSA$Fst,VTvsNTRG$Fst,VTvsNTSB$Fst,VTvsVA$Fst,VTvsCZ$Fst,VTvsTl$Fst,VTvsMa$Fst,VTvsCP$Fst)
Michoacan<-                                                                                                                      c(SMvsAj$Fst,AjvsMiAl$Fst,SRXvsMiAl$Fst,ECvsMiAl$Fst,NCvsMiAl$Fst,NTvsMiAl$Fst,IxvsMiAl$Fst,CBvsMiAl$Fst,PGvsMiAl$Fst,VTvsMiAl$Fst,0,MiAlvsSA$Fst,MiAlvsNTRG$Fst,MiAlvsNTSB$Fst,MiAlvsVA$Fst,MiAlvsCZ$Fst,MiAlvsTl$Fst,MiAlvsMa$Fst,MiAlvsCP$Fst)
SanAndres<-                                                                                                                            c(SMvsAj$Fst,AjvsSA$Fst,SRXvsSA$Fst,ECvsSA$Fst,NCvsSA$Fst,NTvsSA$Fst,IxvsSA$Fst,CBvsSA$Fst,PGvsSA$Fst,VTvsSA$Fst,MiAlvsSA$Fst,0,SAvsNTRG$Fst,SAvsNTSB$Fst,SAvsVA$Fst,SAvsCZ$Fst,SAvsTl$Fst,SAvsMa$Fst,SAvsCP$Fst)
NevadoTolucaRG<-                                                                                       c(SMvsAj$Fst,AjvsNTRG$Fst,SRXvsNTRG$Fst,ECvsNTRG$Fst,NCvsNTRG$Fst,NTvsNTRG$Fst,IxvsNTRG$Fst,CBvsNTRG$Fst,PGvsNTRG$Fst,VTvsNTRG$Fst,MiAlvsNTRG$Fst,SAvsNTRG$Fst,0,NTRGvsNTSB$Fst,NTRGvsVA$Fst,NTRGvsCZ$Fst,NTRGvsTl$Fst,NTRGvsMa$Fst,NTRGvsCP$Fst)
NevadoTolucaSB<-                                                                          c(SMvsAj$Fst,AjvsNTSB$Fst,SRXvsNTSB$Fst,ECvsNTSB$Fst,NCvsNTSB$Fst,NTvsNTSB$Fst,IxvsNTSB$Fst,CBvsNTSB$Fst,PGvsNTSB$Fst,VTvsNTSB$Fst,MiAlvsNTSB$Fst,SAvsNTSB$Fst,NTRGvsNTSB$Fst,0,NTSBvsVA$Fst,NTSBvsCZ$Fst,NTSBvsTl$Fst,NTSBvsMa$Fst,NTSBvsCP$Fst)
VolcanAtlitzin<-                                                                                       c(SMvsAj$Fst,AjvsVA$Fst,SRXvsVA$Fst,ECvsVA$Fst,NCvsVA$Fst,NTvsVA$Fst,IxvsVA$Fst,CBvsVA$Fst,PGvsVA$Fst,VTvsVA$Fst,MiAlvsVA$Fst,SAvsVA$Fst,NTRGvsVA$Fst,NTSBvsVA$Fst,0,VAvsCZ$Fst,VAvsTl$Fst,VAvsMa$Fst,VAvsCP$Fst)
CerroZamorano<-                                                                               c(SMvsAj$Fst,AjvsCZ$Fst,SRXvsCZ$Fst,ECvsCZ$Fst,NCvsCZ$Fst,NTvsCZ$Fst,IxvsCZ$Fst,CBvsCZ$Fst,PGvsCZ$Fst,VTvsCZ$Fst,MiAlvsCZ$Fst,SAvsCZ$Fst,NTRGvsCZ$Fst,NTSBvsCZ$Fst,VAvsCZ$Fst,0,CZvsTl$Fst,CZvsMa$Fst,CZvsCP$Fst)
Tlaxco<-                                                                             c(SMvsAj$Fst,AjvsTl$Fst,SRXvsTl$Fst,ECvsTl$Fst,NCvsTl$Fst,NTvsTl$Fst,IxvsTl$Fst,CBvsTl$Fst,PGvsTl$Fst,VTvsTl$Fst,MiAlvsTl$Fst,SAvsTl$Fst,NTRGvsTl$Fst,NTSBvsTl$Fst,VAvsTl$Fst,CZvsTl$Fst,0,TlvsMa$Fst,TlvsCP$Fst)
Malinche<-                                                                  c(SMvsAj$Fst,AjvsMa$Fst,SRXvsMa$Fst,ECvsMa$Fst,NCvsMa$Fst,NTvsMa$Fst,IxvsMa$Fst,CBvsMa$Fst,PGvsMa$Fst,VTvsMa$Fst,MiAlvsMa$Fst,SAvsMa$Fst,NTRGvsMa$Fst,NTSBvsMa$Fst,VAvsMa$Fst,CZvsMa$Fst,TlvsMa$Fst,0,MavsCP$Fst)
CofrePerote<-                                                      c(SMvsAj$Fst,AjvsCP$Fst,SRXvsCP$Fst,ECvsCP$Fst,NCvsCP$Fst,NTvsCP$Fst,IxvsCP$Fst,CBvsCP$Fst,PGvsCP$Fst,VTvsCP$Fst,MiAlvsCP$Fst,SAvsCP$Fst,NTRGvsCP$Fst,NTSBvsCP$Fst,VAvsCP$Fst,CZvsCP$Fst,TlvsCP$Fst,MavsCP$Fst,0)
mat <- cbind(SierraManantlan,Ajusco, SantaRosaXochiac, ElChico,NevadoColima,NevadoToluca,
Ixtapaluca,CerroBlanco,PuertaGarnica,VolcanTancitaro,Michoacan,
SanAndres,NevadoTolucaRG,NevadoTolucaSB,VolcanAtlitzin,
CerroZamorano,Tlaxco, Malinche,CofrePerote
)
mat2<- mat/(1-mat)
Fst.dists<- as.matrix(mat)
mountain.dists <- dist(cbind(x$Lon, x$Lat))
mountain.dists <- as.matrix(mountain.dists)[1:19, 1:19]
Fst.dists<- as.dist(mat)
mountain.dists <-as.dist(mountain.dists)
mantel(mountain.dists, Fst.dists, method="pearson", permutations=999)
# Linearize as suggested by Rousset (1997) for IBD using FST/(1 − FST)
IBD$FST_liner<- IBD$FST/(1-IBD$FST)
IBD$Dist_km <- IBD$Dist/1000
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Distancia geográfica (Km)")+
ylab("Distancia Genética")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "#e60000") +
xlab("Geographic distance (Km)")+
ylab("Genetic distance")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "black") +
xlab("Geographic distance (Km)")+
ylab("Genetic distance")+
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
## Draw IBD using FST/(1 − FST)
ggplot(data = IBD, aes(x = IBD$Dist_km, y = IBD$FST_liner)) +
geom_point(colour = "black") +
xlab("Geographic distance (Km)")+
ylab("Genetic distance")+
theme_light() +
theme(plot.title = element_text(hjust = 0.5))+
geom_smooth(method=lm)+
theme(axis.title.y = element_text(size = rel(1.5), angle = 90))+
theme(axis.title.x = element_text(size = rel(1.5), angle = 360))+
theme(axis.text.x = element_text(hjust = .5, size=10, color="black"))+
theme(axis.text.y = element_text(hjust = .5, size=10, color="black"))
ggsave("../../outputs/5.1_Mantel_test_Linear.png")
## Make  mantel test
pairs(x = IBD, lower.panel = NULL)
pairs.panels(x = IBD, ellipses = FALSE, lm = TRUE, method = "pearson")
## Make a matrix to mantel test
mat2<- mat/(1-mat)
Fst.dists<- as.matrix(mat2)
mountain.dists <- dist(cbind(x$Lon, x$Lat))
mountain.dists <- as.matrix(mountain.dists)[1:19, 1:19]
Fst.dists<- as.dist(mat2)
mountain.dists <-as.dist(mountain.dists)
mantel(mountain.dists, Fst.dists, method="pearson", permutations=999)
